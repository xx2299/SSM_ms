% Parameter setting #1
movmethod=2;
window=5;
maxlen=40;
order=40;
A1=A(:,1:97846);
SMAP_Ayy1=fill_nan(A1,movmethod,window,maxlen,order);
A2=A(:,97847:195692);
SMAP_Ayy2=fill_nan(A2,movmethod,window,maxlen,order);
A3=A(:,195693:293538);
SMAP_Ayy3=fill_nan(A3,movmethod,window,maxlen,order);
A4=A(:,293539:391384);
SMAP_Ayy4=fill_nan(A4,movmethod,window,maxlen,order);
SMAP_Ayy=[SMAP_Ayy1,SMAP_Ayy2,SMAP_Ayy3,SMAP_Ayy4];
N=1093;
SMAP_Ayy=SMAP_Ayy/(N/2);
Fs=1;
F=((1:N)-1)*Fs/N;
x=F;
a=find(abs(x-1/7)<=0.0004);
b=find(abs(x-1/30)<=0.0004);
c=find(abs(x-1/90)<=0.0004);
d=find(abs(x-1/365)<=0.0002);
SMAP_ybar1=nansum(SMAP_Ayy(b:a,:));
YBAR1=reshape(SMAP_ybar1,[964,406]);
Fybar1=YBAR1.';
SMAP_ybar2=nansum(SMAP_Ayy(c:b,:));
YBAR2=reshape(SMAP_ybar2,[964,406]);
Fybar2=YBAR2.';
SMAP_ybar3=nansum(SMAP_Ayy(d:c,:));
YBAR3=reshape(SMAP_ybar3,[964,406]);
Fybar3=YBAR3.';
SMF1_mean_5_40_40=Fybar1./(Fybar1+Fybar2+Fybar3);
SMF2_mean_5_40_40=Fybar2./(Fybar1+Fybar2+Fybar3);
SMF3_mean_5_40_40=Fybar3./(Fybar1+Fybar2+Fybar3);
% Parameter setting #2
movmethod=1;
window=5;
maxlen=40;
order=40;
A1=A(:,1:97846);
SMAP_Ayy1=fill_nan(A1,movmethod,window,maxlen,order);
A2=A(:,97847:195692);
SMAP_Ayy2=fill_nan(A2,movmethod,window,maxlen,order);
A3=A(:,195693:293538);
SMAP_Ayy3=fill_nan(A3,movmethod,window,maxlen,order);
A4=A(:,293539:391384);
SMAP_Ayy4=fill_nan(A4,movmethod,window,maxlen,order);
SMAP_Ayy=[SMAP_Ayy1,SMAP_Ayy2,SMAP_Ayy3,SMAP_Ayy4];
N=1093;
SMAP_Ayy=SMAP_Ayy/(N/2);
Fs=1;
F=((1:N)-1)*Fs/N;
x=F;
a=find(abs(x-1/7)<=0.0004);
b=find(abs(x-1/30)<=0.0004);
c=find(abs(x-1/90)<=0.0004);
d=find(abs(x-1/365)<=0.0002);
SMAP_ybar1=nansum(SMAP_Ayy(b:a,:));
YBAR1=reshape(SMAP_ybar1,[964,406]);
Fybar1=YBAR1.';
SMAP_ybar2=nansum(SMAP_Ayy(c:b,:));
YBAR2=reshape(SMAP_ybar2,[964,406]);
Fybar2=YBAR2.';
SMAP_ybar3=nansum(SMAP_Ayy(d:c,:));
YBAR3=reshape(SMAP_ybar3,[964,406]);
Fybar3=YBAR3.';
SMF1_median_5_40_40=Fybar1./(Fybar1+Fybar2+Fybar3);
SMF2_median_5_40_40=Fybar2./(Fybar1+Fybar2+Fybar3);
SMF3_median_5_40_40=Fybar3./(Fybar1+Fybar2+Fybar3);
% Parameter setting #3
movmethod=2;
window=10;
maxlen=40;
order=40;
A1=A(:,1:97846);
SMAP_Ayy1=fill_nan(A1,movmethod,window,maxlen,order);
A2=A(:,97847:195692);
SMAP_Ayy2=fill_nan(A2,movmethod,window,maxlen,order);
A3=A(:,195693:293538);
SMAP_Ayy3=fill_nan(A3,movmethod,window,maxlen,order);
A4=A(:,293539:391384);
SMAP_Ayy4=fill_nan(A4,movmethod,window,maxlen,order);
SMAP_Ayy=[SMAP_Ayy1,SMAP_Ayy2,SMAP_Ayy3,SMAP_Ayy4];
N=1093;
SMAP_Ayy=SMAP_Ayy/(N/2);
Fs=1;
F=((1:N)-1)*Fs/N;
x=F;
a=find(abs(x-1/7)<=0.0004);
b=find(abs(x-1/30)<=0.0004);
c=find(abs(x-1/90)<=0.0004);
d=find(abs(x-1/365)<=0.0002);
SMAP_ybar1=nansum(SMAP_Ayy(b:a,:));
YBAR1=reshape(SMAP_ybar1,[964,406]);
Fybar1=YBAR1.';
SMAP_ybar2=nansum(SMAP_Ayy(c:b,:));
YBAR2=reshape(SMAP_ybar2,[964,406]);
Fybar2=YBAR2.';
SMAP_ybar3=nansum(SMAP_Ayy(d:c,:));
YBAR3=reshape(SMAP_ybar3,[964,406]);
Fybar3=YBAR3.';
SMF1_mean_10_40_40=Fybar1./(Fybar1+Fybar2+Fybar3);
SMF2_mean_10_40_40=Fybar2./(Fybar1+Fybar2+Fybar3);
SMF3_mean_10_40_40=Fybar3./(Fybar1+Fybar2+Fybar3);
% Parameter setting #4
movmethod=2;
window=5;
maxlen=80;
order=40;
A1=A(:,1:97846);
SMAP_Ayy1=fill_nan(A1,movmethod,window,maxlen,order);
A2=A(:,97847:195692);
SMAP_Ayy2=fill_nan(A2,movmethod,window,maxlen,order);
A3=A(:,195693:293538);
SMAP_Ayy3=fill_nan(A3,movmethod,window,maxlen,order);
A4=A(:,293539:391384);
SMAP_Ayy4=fill_nan(A4,movmethod,window,maxlen,order);
SMAP_Ayy=[SMAP_Ayy1,SMAP_Ayy2,SMAP_Ayy3,SMAP_Ayy4];
N=1093;
SMAP_Ayy=SMAP_Ayy/(N/2);
Fs=1;
F=((1:N)-1)*Fs/N;
x=F;
a=find(abs(x-1/7)<=0.0004);
b=find(abs(x-1/30)<=0.0004);
c=find(abs(x-1/90)<=0.0004);
d=find(abs(x-1/365)<=0.0002);
SMAP_ybar1=nansum(SMAP_Ayy(b:a,:));
YBAR1=reshape(SMAP_ybar1,[964,406]);
Fybar1=YBAR1.';
SMAP_ybar2=nansum(SMAP_Ayy(c:b,:));
YBAR2=reshape(SMAP_ybar2,[964,406]);
Fybar2=YBAR2.';
SMAP_ybar3=nansum(SMAP_Ayy(d:c,:));
YBAR3=reshape(SMAP_ybar3,[964,406]);
Fybar3=YBAR3.';
SMF1_mean_5_80_40=Fybar1./(Fybar1+Fybar2+Fybar3);
SMF2_mean_5_80_40=Fybar2./(Fybar1+Fybar2+Fybar3);
SMF3_mean_5_80_40=Fybar3./(Fybar1+Fybar2+Fybar3);
% Parameter setting #5
movmethod=2;
window=5;
maxlen=40;
order=80;
A1=A(:,1:97846);
SMAP_Ayy1=fill_nan(A1,movmethod,window,maxlen,order);
A2=A(:,97847:195692);
SMAP_Ayy2=fill_nan(A2,movmethod,window,maxlen,order);
A3=A(:,195693:293538);
SMAP_Ayy3=fill_nan(A3,movmethod,window,maxlen,order);
A4=A(:,293539:391384);
SMAP_Ayy4=fill_nan(A4,movmethod,window,maxlen,order);
SMAP_Ayy=[SMAP_Ayy1,SMAP_Ayy2,SMAP_Ayy3,SMAP_Ayy4];
N=1093;
SMAP_Ayy=SMAP_Ayy/(N/2);
Fs=1;
F=((1:N)-1)*Fs/N;
x=F;
a=find(abs(x-1/7)<=0.0004);
b=find(abs(x-1/30)<=0.0004);
c=find(abs(x-1/90)<=0.0004);
d=find(abs(x-1/365)<=0.0002);
SMAP_ybar1=nansum(SMAP_Ayy(b:a,:));
YBAR1=reshape(SMAP_ybar1,[964,406]);
Fybar1=YBAR1.';
SMAP_ybar2=nansum(SMAP_Ayy(c:b,:));
YBAR2=reshape(SMAP_ybar2,[964,406]);
Fybar2=YBAR2.';
SMAP_ybar3=nansum(SMAP_Ayy(d:c,:));
YBAR3=reshape(SMAP_ybar3,[964,406]);
Fybar3=YBAR3.';
SMF1_mean_5_40_80=Fybar1./(Fybar1+Fybar2+Fybar3);
SMF2_mean_5_40_80=Fybar2./(Fybar1+Fybar2+Fybar3);
SMF3_mean_5_40_80=Fybar3./(Fybar1+Fybar2+Fybar3);
% Remove regions with limited SSM
SMF1_mean_10_80_40(SMAP_mean_SM<0.1)=0;
SMF2_mean_10_80_40(SMAP_mean_SM<0.1)=0;
SMF3_mean_10_80_40(SMAP_mean_SM<0.1)=0.1;
SMF1_median_10_80_40(SMAP_mean_SM<0.1)=0;
SMF2_median_10_80_40(SMAP_mean_SM<0.1)=0;
SMF3_median_10_80_40(SMAP_mean_SM<0.1)=0.1;
SMF1_mean_5_80_40(SMAP_mean_SM<0.1)=0;
SMF2_mean_5_80_40(SMAP_mean_SM<0.1)=0;
SMF3_mean_5_80_40(SMAP_mean_SM<0.1)=0.1;
SMF1_mean_10_40_40(SMAP_mean_SM<0.1)=0;
SMF2_mean_10_40_40(SMAP_mean_SM<0.1)=0;
SMF3_mean_10_40_40(SMAP_mean_SM<0.1)=0.1;
SMF1_mean_10_80_80(SMAP_mean_SM<0.1)=0;
SMF2_mean_10_80_80(SMAP_mean_SM<0.1)=0;
SMF3_mean_10_80_80(SMAP_mean_SM<0.1)=0.1;
% Plot the figure (Figure S8)
detalgx=lonSMAP;
detalgy=latSMAP;
TightPlot.ColumeNumber=5;
TightPlot.RowNumber=3;
TightPlot.GapW=0.022;
TightPlot.GapH=0.04;
TightPlot.MarginsLower=0.1;
TightPlot.MarginsUpper=0.035;
TightPlot.MarginsLeft=0.05;
TightPlot.MarginsRight=0.6;
p=tight_subplot(TightPlot.ColumeNumber,TightPlot.RowNumber,...
  [TightPlot.GapH TightPlot.GapW],...
  [TightPlot.MarginsLower TightPlot.MarginsUpper],...
  [TightPlot.MarginsLeft TightPlot.MarginsRight]);
var_list={SMF1_mean_10_80_40,SMF2_mean_10_80_40,SMF3_mean_10_80_40,SMF1_median_10_80_40,SMF2_median_10_80_40,SMF3_median_10_80_40,SMF1_mean_5_80_40,SMF2_mean_5_80_40,SMF3_mean_5_80_40...
    SMF1_mean_10_40_40,SMF2_mean_10_40_40,SMF3_mean_10_40_40,SMF1_mean_10_80_80,SMF2_mean_10_80_80,SMF3_mean_10_80_80};
map=surface(1,15);
for i=1:15
    axes(p(i));
    map(i)=pcolor(detalgx,detalgy,var_list{i});
end
axes(p(1))
set(map(1),'alphadata',~isnan(SMF1_mean_10_80_40))
shading interp
colorbar
caxis([0,0.5])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
xlabel('(a)','FontSize',9.5)
ylabel('mean-10-80-40','FontSize',9.5,'FontWeight','bold')
title('1/30<f<1/7 day^{-1}','FontSize',9.5,'FontWeight','bold')
axes(p(2))
set(map(2),'alphadata',~isnan(SMF2_mean_10_80_40))
shading interp
colorbar
caxis([0,0.5])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
set(gca,'YTickLabel','')
xlabel('(b)','FontSize',9.5)
title('1/90<f<1/30 day^{-1}','FontSize',9.5,'FontWeight','bold')
axes(p(3))
set(map(3),'alphadata',~isnan(SMF3_mean_10_80_40))
shading interp
colorbar
caxis([0.1,0.6])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
set(gca,'YTickLabel','')
xlabel('(c)','FontSize',9.5)
title('1/365<f<1/90 day^{-1}','FontSize',9.5,'FontWeight','bold')
axes(p(4))
set(map(4),'alphadata',~isnan(SMF1_median_10_80_40))
shading interp
colorbar
caxis([0,0.5])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
xlabel('(d)','FontSize',9.5)
ylabel('median-10-80-40','FontSize',9.5,'FontWeight','bold')
axes(p(5))
set(map(5),'alphadata',~isnan(SMF2_median_10_80_40))
shading interp
colorbar
caxis([0,0.5])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
set(gca,'YTickLabel','')
xlabel('(e)','FontSize',9.5)
axes(p(6))
set(map(6),'alphadata',~isnan(SMF3_median_10_80_40))
shading interp
colorbar
caxis([0.1,0.6])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
set(gca,'YTickLabel','')
xlabel('(f)','FontSize',9.5)
axes(p(7))
set(map(7),'alphadata',~isnan(SMF1_mean_5_80_40))
shading interp
colorbar
caxis([0,0.5])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
xlabel('(g)','FontSize',9.5)
ylabel('mean-5-80-40','FontSize',9.5,'FontWeight','bold')
axes(p(8))
set(map(8),'alphadata',~isnan(SMF2_mean_5_80_40))
shading interp
colorbar
caxis([0,0.5])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
set(gca,'YTickLabel','')
xlabel('(h)','FontSize',9.5)
axes(p(9))
set(map(9),'alphadata',~isnan(SMF3_mean_5_80_40))
shading interp
colorbar
caxis([0.1,0.6])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
set(gca,'YTickLabel','')
xlabel('(i)','FontSize',9.5)
axes(p(10))
set(map(10),'alphadata',~isnan(SMF1_mean_10_40_40))
shading interp
colorbar
caxis([0,0.5])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
xlabel('(j)','FontSize',9.5)
ylabel('mean-10-40-40','FontSize',9.5,'FontWeight','bold')
axes(p(11))
set(map(11),'alphadata',~isnan(SMF2_mean_10_40_40))
shading interp
colorbar
caxis([0,0.5])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
set(gca,'YTickLabel','')
xlabel('(k)','FontSize',9.5)
axes(p(12))
set(map(12),'alphadata',~isnan(SMF3_mean_10_40_40))
shading interp
colorbar
caxis([0.1,0.6])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'XTickLabel','')
set(gca,'YTick',[-60,-30,0,30,60])
set(gca,'YTickLabel','')
xlabel('(l)','FontSize',9.5)
axes(p(13))
set(map(13),'alphadata',~isnan(SMF1_mean_10_80_80))
shading interp
colorbar
caxis([0,0.5])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'YTick',[-60,-30,0,30,60])
xlabel('(m)','FontSize',9.5)
ylabel('mean-10-80-80','FontSize',9.5,'FontWeight','bold')
axes(p(14))
set(map(14),'alphadata',~isnan(SMF2_mean_10_80_80))
shading interp
colorbar
caxis([0,0.5])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'YTick',[-60,-30,0,30,60])
set(gca,'YTickLabel','')
xlabel('(n)','FontSize',9.5)
axes(p(15))
set(map(15),'alphadata',~isnan(SMF3_mean_10_80_80))
shading interp
colorbar
caxis([0.1,0.6])
set(gca,'XTick',[-120,-60,0,60,120])
set(gca,'YTick',[-60,-30,0,30,60])
set(gca,'YTickLabel','')
xlabel('(o)','FontSize',9.5)
axes('position',[0.05,-0.018,0.102,0.23])
axis off
caxis([0,0.5])
colorbar('southoutside','Ticks',[0,0.25,0.5])
axes('position',[0.1745,-0.018,0.102,0.23])
axis off
colorbar('southoutside','Ticks',[0,0.25,0.5])
caxis([0,0.5])
axes('position',[0.298,-0.018,0.102,0.23])
axis off
colorbar('southoutside','Ticks',[0.1,0.35,0.6])
caxis([0.1,0.6])